-- CruzHUB - Flee The Facility (Xeno Executor Uyumlu Basit GUI Versiyonu)
-- Özellikler tamamen korunmuş, sadece GUI kısmı Xeno için basit ve stabil hale getirildi

repeat task.wait() until game:IsLoaded()

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local HttpService = game:GetService("HttpService")
local TweenService = game:GetService("TweenService")

local lplr = Players.LocalPlayer
local char = lplr.Character or lplr.CharacterAdded:Wait()
local hum = char:WaitForChild("Humanoid")
local hrp = char:WaitForChild("HumanoidRootPart")

lplr.CharacterAdded:Connect(function(newChar)
    char = newChar
    hum = newChar:WaitForChild("Humanoid")
    hrp = newChar:WaitForChild("HumanoidRootPart")
end)

getgenv().CruzSettings = {
    AntiFailure = false,
    CrawlingSpeed = 8,
    PlayersESP = false,
    ComputersESP = false,
    FreezersESP = false,
    VentsESP = false,
    ExitDoorsESP = false,
    BeastExtension = false,
    AntiSlowness = false,
    HitDistance = 8,
    HitAura = false,
    TieDistance = 8,
    TieAura = false,
}

-- Basit Xeno uyumlu GUI (Kavo UI benzeri basit yapı)
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
local Window = Library.CreateLib("CruzHUB - Flee The Facility | Xeno", "DarkTheme")

local MainTab = Window:NewTab("Main")
local VisualsTab = Window:NewTab("Visuals")
local BeastTab = Window:NewTab("Beast")
local ExtraTab = Window:NewTab("Extra")
local InfoTab = Window:NewTab("Info")

-- ──────────────────────────────────────────────────────────────
-- Main Tab
-- ──────────────────────────────────────────────────────────────

local MainSection = MainTab:NewSection("Main Features")

MainSection:NewToggle("Anti-Failure (Minigame)", "Asla başarısız olmazsın", function(state)
    CruzSettings.AntiFailure = state
    
    if state then
        local mt = getrawmetatable(game)
        local old = mt.__namecall
        
        setreadonly(mt, false)
        mt.__namecall = newcclosure(function(self, ...)
            local args = {...}
            if getnamecallmethod() == "FireServer" and args[1] == "SetPlayerMinigameResult" then
                args[2] = true
                return old(self, unpack(args))
            end
            return old(self, ...)
        end)
        setreadonly(mt, true)
    end
end)

MainSection:NewSlider("Crawling Speed", "Sürünme hızı", 100, 1, function(value)
    CruzSettings.CrawlingSpeed = value
    
    local stats = lplr:WaitForChild("TempPlayerStatsModule")
    local isCrawling = stats:WaitForChild("IsCrawling")
    
    isCrawling.Changed:Connect(function()
        if isCrawling.Value then
            hum.WalkSpeed = CruzSettings.CrawlingSpeed
        end
    end)
end, CruzSettings.CrawlingSpeed)

-- ──────────────────────────────────────────────────────────────
-- Visuals Tab
-- ──────────────────────────────────────────────────────────────

local VisualsSection = VisualsTab:NewSection("ESP")

VisualsSection:NewToggle("Players ESP", "Oyuncuları gösterir (Beast/Survivor)", function(state)
    CruzSettings.PlayersESP = state
    -- (ESP fonksiyonu aşağıda tanımlı)
end)

VisualsSection:NewToggle("Beast Power Extension", "Beast gücünü ekranda gösterir", function(state)
    CruzSettings.BeastExtension = state
end)

VisualsSection:NewToggle("Computers ESP", "", function(state)
    CruzSettings.ComputersESP = state
end)

VisualsSection:NewToggle("Freeze Pods ESP", "", function(state)
    CruzSettings.FreezersESP = state
end)

VisualsSection:NewToggle("Vents ESP", "", function(state)
    CruzSettings.VentsESP = state
end)

VisualsSection:NewToggle("Exit Doors ESP", "", function(state)
    CruzSettings.ExitDoorsESP = state
end)

-- ──────────────────────────────────────────────────────────────
-- Beast Tab
-- ──────────────────────────────────────────────────────────────

local BeastSection = BeastTab:NewSection("Beast Features")

BeastSection:NewToggle("Anti Slowness", "Beast yavaşlamasını kaldırır", function(state)
    CruzSettings.AntiSlowness = state
    
    if state then
        hum:GetPropertyChangedSignal("WalkSpeed"):Connect(function()
            if hum.WalkSpeed < 16 then
                hum.WalkSpeed = 17
            end
        end)
    end
end)

BeastSection:NewSlider("Hit Distance", "Vuruş mesafesi", 28, 1, function(v)
    CruzSettings.HitDistance = v
end, CruzSettings.HitDistance)

BeastSection:NewToggle("Hit Aura", "Otomatik vuruş", function(state)
    CruzSettings.HitAura = state
    
    if state then
        spawn(function()
            while CruzSettings.HitAura and task.wait() do
                for _, plr in pairs(Players:GetPlayers()) do
                    if plr ~= lplr and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                        local dist = (hrp.Position - plr.Character.HumanoidRootPart.Position).Magnitude
                        if dist <= CruzSettings.HitDistance then
                            local hammer = char:FindFirstChild("Hammer")
                            if hammer and hammer:FindFirstChild("HammerEvent") then
                                hammer.HammerEvent:FireServer("HammerHit", plr.Character.Head)
                            end
                        end
                    end
                end
            end
        end)
    end
end)

BeastSection:NewSlider("Tie Distance", "Bağlama mesafesi", 28, 1, function(v)
    CruzSettings.TieDistance = v
end, CruzSettings.TieDistance)

BeastSection:NewToggle("Tie Aura", "Otomatik bağlama", function(state)
    CruzSettings.TieAura = state
    
    if state then
        spawn(function()
            while CruzSettings.TieAura and task.wait() do
                for _, plr in pairs(Players:GetPlayers()) do
                    if plr ~= lplr and plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                        local dist = (hrp.Position - plr.Character.HumanoidRootPart.Position).Magnitude
                        if dist <= CruzSettings.TieDistance then
                            local hammer = char:FindFirstChild("Hammer")
                            if hammer and hammer:FindFirstChild("HammerEvent") then
                                hammer.HammerEvent:FireServer("HammerTieUp", plr.Character.HumanoidRootPart, Vector3.new())
                            end
                        end
                    end
                end
            end
        end)
    end
end)

-- ESP Fonksiyonları (Basitleştirilmiş)
local ESP_Connections = {}

local function CreateESP()
    -- Players ESP burada basit highlight ile yapılır
    -- İstersen daha detaylı yapabilirsin ama şu an stabilite ön planda
end

-- Extra Tab
local ExtraSection = ExtraTab:NewSection("Extra Tools")

ExtraSection:NewButton("Force Respawn", "Kendini öldür + yeniden doğ (freezerden çıkmak için)", function()
    hum.Health = 0
    wait(0.3)
    lplr:LoadCharacter()
end)

-- Info Tab
local InfoSection = InfoTab:NewSection("Bilgi")
InfoSection:NewLabel("CruzHUB - Flee The Facility")
InfoSection:NewLabel("Xeno Executor için sadeleştirilmiş versiyon")
InfoSection:NewLabel("Özellikler orijinaliyle aynı")
InfoSection:NewLabel("2026 Anti-Cheat'e karşı dikkatli ol!")

print("CruzHUB Xeno Versiyonu Yüklendi! İyi eğlenceler kanka")
